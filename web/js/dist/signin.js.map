{"version":3,"sources":["../../es6/signin.js"],"names":["SignIn","clicked","model","selector","rules","regex","value","error","required","onSignInConfirmClick","bind","checkValidation","setModalListeners","setUpListeners","$","click","modal","setUpOnBlurListeners","on","window","location","href","includes","resetForm","map","v","index","self","blur","showError","forEach","val","hide","element","errorElement","next","message","valid","RegExp","test","text","show","retrunVal","i","length","loginUser","data","phone_number","password","remember_me","axios","post","then","response","success","hasClass","toaster","settings","timeout","priority","title","alert","document","ready"],"mappings":"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","sourcesContent":["class SignIn {\r\n  constructor() {\r\n    this.clicked = false;\r\n    this.model = [\r\n      {\r\n        selector: \"loginPhone\",\r\n        rules: {\r\n          regex: {\r\n            value: /^[0-9]{10}$/,\r\n            error: \"Phone Number must have 10 digits.\",\r\n          },\r\n        },\r\n        value: \"\",\r\n      },\r\n      {\r\n        selector: \"loginPassword\",\r\n        rules: {\r\n          required: {\r\n            value: true,\r\n            error: \"Password is required.\",\r\n          },\r\n        },\r\n        value: \"\",\r\n      },\r\n    ];\r\n    this.onSignInConfirmClick = this.onSignInConfirmClick.bind(this);\r\n    this.checkValidation = this.checkValidation.bind(this);\r\n    this.setModalListeners = this.setModalListeners.bind(this);\r\n    this.setUpListeners();\r\n  }\r\n\r\n  setUpListeners() {\r\n    $(\".confirm-signin\").click(this.onSignInConfirmClick);\r\n    $(\".register-signin\").click(function () {\r\n      $(\"#signinModal\").modal(\"hide\");\r\n      $(\"#signupModal\").modal(\"show\");\r\n    });\r\n    this.setUpOnBlurListeners();\r\n    this.setModalListeners();\r\n  }\r\n\r\n  setModalListeners() {\r\n    $(\"#signinModal\").on(\"hidden.bs.modal\", () => {\r\n      if (window.location.href.includes(\"/user/login\")) {\r\n        window.location.href = \"/\";\r\n      } else this.resetForm();\r\n    });\r\n  }\r\n\r\n  setUpOnBlurListeners() {\r\n    this.model.map((v, index) => {\r\n      const { selector, rules } = v;\r\n      const self = this;\r\n      $(`#${selector}`).blur(function () {\r\n        if (self.clicked) self.showError(selector, rules, index);\r\n      });\r\n    });\r\n  }\r\n\r\n  resetForm() {\r\n    this.model.forEach((v) => {\r\n      const { selector } = v;\r\n      $(`#${selector}`).val(\"\");\r\n      v.value = \"\";\r\n    });\r\n    $(\".invalid-feedback\").hide();\r\n  }\r\n\r\n  showError(selector, rules, index) {\r\n    const element = $(`#${selector}`);\r\n    const value = element.val();\r\n    const errorElement = element.next();\r\n    let message = \"\";\r\n    let valid = true;\r\n\r\n    if (!value && rules.required && rules.required.value) {\r\n      valid = false;\r\n      message = rules.required.error;\r\n    } else if (rules.regex) {\r\n      valid = new RegExp(rules.regex.value).test(value);\r\n      if (rules.required && rules.required.value === false) {\r\n        valid = !value || valid;\r\n      }\r\n      if (!valid) message = rules.regex.error;\r\n    }\r\n\r\n    if (!valid && message) {\r\n      errorElement.text(message);\r\n      errorElement.show();\r\n    } else {\r\n      errorElement.text(\"\");\r\n      errorElement.hide();\r\n    }\r\n    this.model[index].value = value;\r\n    return valid;\r\n  }\r\n\r\n  checkValidation() {\r\n    let valid = true;\r\n    let retrunVal = true;\r\n    for (let i = 0; i < this.model.length; i++) {\r\n      const { selector, rules } = this.model[i];\r\n      valid = this.showError(selector, rules, i);\r\n      if (!valid) retrunVal = false;\r\n    }\r\n    return retrunVal;\r\n  }\r\n\r\n  onSignInConfirmClick() {\r\n    this.clicked = true;\r\n    const valid = this.checkValidation();\r\n    if (valid) {\r\n      this.loginUser();\r\n    }\r\n  }\r\n\r\n  loginUser() {\r\n    const { model } = this;\r\n    const data = {\r\n      phone_number: model[0].value,\r\n      password: model[1].value,\r\n      remember_me: $(\"#rememberMe:checked\").val() ? 1 : 0,\r\n    };\r\n\r\n    axios\r\n      .post(\"/user/login\", data)\r\n      .then(({ data: response }) => {\r\n        if (response && response.success) {\r\n          if ($(\"#searchModal\").hasClass(\"show\")) {\r\n            $(\"#signinModal\").modal(\"hide\");\r\n          } else window.location.href = \"/dashboard\";\r\n        } else {\r\n          $.toaster({ settings: { timeout: 5000 } });\r\n          $.toaster({\r\n            priority: \"danger\",\r\n            title: \"Error\",\r\n            message: `Invalid phone and/or password`,\r\n          });\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        alert(\"Error while saving the data\");\r\n      });\r\n  }\r\n}\r\n\r\n$(document).ready(function () {\r\n  new SignIn();\r\n});\r\n"],"file":"signin.js"}